%%% MAIN LAYOUT 
%%%------------
% \setlrmarginsandblock{0.15\paperwidth}{*}{1} % Left and right margin
% \setulmarginsandblock{0.2\paperwidth}{*}{1}  % Upper and lower margin
\setlrmarginsandblock{0.5in}{*}{1} % Left and right margin
% \setulmarginsandblock{1.0in}{*}{1}  % Upper and lower margin
\setulmarginsandblock{1.0in}{0.75in}{*}  % Upper and lower margin
% \setlength{\footskip}{0.75in}
\checkandfixthelayout


%%% TABLE OF CONTENTS
%%%-------------------
\maxtocdepth{section} % Only parts, chapters and sections in the table of contents
\settocdepth{section}

\AtEndDocument{\addtocontents{toc}{\par}} % Add a \par to the end of the TOC

% \renewcommand{\cftchapterfont}{\bfseries\small}
\renewcommand{\cftchapterfont}{\bfseries\scshape\large}
% \renewcommand{\cftsectionfont}{\footnotesize}
% \renewcommand{\cftchapterpagefont}{\bfseries\small}   
% \renewcommand{\cftsectionpagefont}{\footnotesize} 

% this makes multitoc columns unbalanced
\makeatletter
\renewcommand*{\@starttoc}[1]{%
   \ifthenelse{\boolean{@multitoc@toc}\and\equal{#1}{toc}}{%
      \begin{multicols*}{\multicolumntoc}%
         \@multitoc@starttoc{#1}%
      \end{multicols*}%
      }{}%
   }
\makeatother

%%% PARAGRAPHS
%%%-----------
% \setlength{\parskip}{0.5\baselineskip}
% \setlength{\parindent}{0pt}
\nonzeroparskip % recommended by memoir


%%% PAGE HEADERS
%%%-------------
% define what goes where in the header
% chapter into \leftmark, number shown, nothing before the
% number and a dot and space after it
% \createmark{chapter}{left}{shownumber}{}{. }
\createmark{chapter}{left}{shownumber}{Chapter }{: }
% section into \rightmark
\createmark{section}{right}{nonumber}{}{}

\nouppercaseheads

% \makeevenhead{headings}
%     {\small\thepage}
%     {\small\scshape\leftmark}
%     {\small\scshape}
% \makeoddhead{headings}
%     {}
%     {\small\scshape\rightmark}
%     {\small\thepage}
% \makeheadrule{headings}{\textwidth}{.2pt}

% \makeoddhead{headings}
%     {}
%     {\small\scshape\leftmark\enspace \ifthenelse{\equal{\rightmark}{} \OR \equal{\leftmark}{}}{}{---}\enspace\rightmark}
%     {} % {\small\thepage}
\makeoddhead{headings}
    {}
    {\small\scshape\leftmark}
    {} % {\small\thepage}
\makeoddfoot{headings}{}{\small\thepage}{}
\makeevenfoot{headings}{}{\small\thepage}{}
\makeheadrule{headings}{\textwidth}{.2pt}


%%% CHAPTER TITLES
%%%---------------
% \chapterstyle{dash}
\chapterstyle{default}
% \setlength{\beforechapskip}{5\onelineskip}

% this lines the chapter dash up with the header-rule on other pages
\setlength{\beforechapskip}{-2.5\baselineskip-\topskip}
% \setlength{\beforechapskip}{0pt}
% \renewcommand{\chapterheadstart}{\vspace*{\beforechapskip}} % the default
% \renewcommand{\chapterheadstart}{\vspace*{-2.5\baselineskip-1\topskip}}
% \renewcommand{\chapterheadstart}{}
\setlength{\afterchapskip}{2\baselineskip}

\renewcommand{\chaptitlefont}{\normalfont\scshape\huge\bfseries}
\renewcommand{\chapnamefont}{\normalfont\scshape\Large\bfseries}
\renewcommand{\chapnumfont}{\normalfont\scshape\Large\bfseries}
\settoheight{\midchapskip}{\chapnumfont 1}


\renewcommand{\printchapternum}{
    \centering \chapnumfont 
    \rule[0.5\midchapskip]{1em}{0.4pt} 
    \;Chapter \thechapter\;
    \rule[0.5\midchapskip]{1em}{0.4pt}
}
\renewcommand*{\printchapternonum}{
    \centering \chapnumfont
    \vphantom{\chapnumfont 1}
    \afterchapternum
}

\renewcommand*{\printchaptername}{}
\renewcommand*{\chapternamenum}{}

\renewcommand*{\afterchapternum}{\par\nobreak\vskip 0.5\onelineskip}
\renewcommand*{\printchaptertitle}[1]{\centering \chaptitlefont #1}

% \let\oldafterchapternum\afterchapternum
% \renewcommand{\afterchapternum}{\par\nobreak}        % To set the line


% \renewcommand{\chapnumfont}{\chaptitlefont}    % To harmonise the font sizes
% \renewcommand{\chapnamefont}{\chaptitlefont}   % idem

%%% CHAPTER SUBTITLES
%%%------------------
\newcommand{\chapterwithsubtitle}[2] {
    \let\oldafterchaptertitle\afterchaptertitle % save the old macro
    \renewcommand{\afterchaptertitle}{ % and temorarily replace it
        \oldafterchaptertitle
        \vspace{-1\afterchapskip} % undo the vertical spacing
        % print the subtitle
        \normalfont \centering \scshape \itshape \large \textcolor{gray}{#2}
        \par
        % and re-apply the vertical spacing
        \vspace{\afterchapskip}
    }
    \chapter{#1} % make the actual chapter
    % and re-instate the original version of the command
    \let\afterchaptertitle\oldafterchaptertitle
}


%%% OTHER HEADERS
%%%--------------
% \setsecnumdepth{subsection}
\setsecnumdepth{chapter}
\setsecheadstyle{\LARGE\scshape\bfseries\raggedright}
% \setsubsecheadstyle{\Large\scshape\bfseries\itshape\raggedright}
\setsubsecheadstyle{\large\scshape\bfseries\raggedright}
\setsubsubsecheadstyle{\normalsize\scshape\bfseries\raggedright}
\setaftersubsubsecskip{1sp} % semi-hack to remove spacing after subsebsections (1sp is the smallest unit)

% \newcommand{\ruledsec}[1]{
%     \LARGE\scshape\bfseries\raggedright #1%
%     % \vspace*{-\baselineskip-4pt}
%     \rule[\baselineskip]{\textwidth}{0.4pt}\par
%     \vspace*{-\baselineskip}
% }
% \setsecheadstyle{\ruledsec}

% \newcommand{\ruledsec}[1]{
%     \LARGE\scshape\bfseries\raggedright \underline{#1}%
% }
% \setsecheadstyle{\ruledsec}


%%% TABLE & LIST COMMANDS
%%%---------------
\newcommand{\ol}[1]{\begin{enumerate}#1\end{enumerate}}
\newcommand{\ul}[1]{\begin{itemize}#1\end{itemize}}
% \newcommand{\li}[1]{\item{#1}}

\newcommand{\centercell}[1]{\multicolumn{1}{c}{#1}}
\newcommand{\tableheader}[1]{\multicolumn{1}{c}{\textbf{#1}}}
\newcommand{\tableheaderspan}[2]{\multicolumn{#1}{c}{\textbf{#2}}}
\newcommand{\tablesubheader}[1]{\multicolumn{1}{c}{#1}}

% \multicolumn{1}{c}{\bfseries\begin{tabular}{@{}c@{}}#1\end{tabular}}}

\renewcommand\theadfont{\bfseries}
\renewcommand\theadalign{cc}
\renewcommand\theadset{\renewcommand\arraystretch{1.2}}
\renewcommand\cellset{\renewcommand\arraystretch{1.2}}

\newcommand{\tsubhead}[1]{
    \renewcommand\theadfont{}
    \thead{#1}
}

% \newcommand\nextrowtext{}
% \newcommand\nextrow[1]{\renewcommand\nextrowtext{#1}}

% \newcommand{\tableheader}[2][1]{}

% the optional command is the array stretch
\newcommand{\fancytable}[5][1.2]{
    % \setlength{\extrarowheight}{#1}
    \protect\renewcommand{\arraystretch}{#1}%
    \begin{center}
        \begin{threeparttable}
            \noindent\begin{tabular}{@{}#2@{}}
                #3
                % \cmidrule(l){3-5}
                \toprule
                #4
                \bottomrule
            \end{tabular}
            \ifthenelse{\isempty{#5}}
            {}{
                \begin{tablenotes}
                    \footnotesize
                    #5
                \end{tablenotes}
            }
        \end{threeparttable}
    \end{center}
}


\setlist[description]{
    style=nextline,
    labelwidth=0pt,
    leftmargin=0pt,
    labelsep=0pt,
    topsep=0pt, 
    % partopsep=0pt,
    % itemindent=\dimexpr-5pt-\labelsep\relax,
}


% {
%     \setlength{\columnseprule}{0pt}
%     \setlength{\columnsep}{1\baselineskip}
%     \begin{multicols}{2}
%     \vfill\null
%     \end{multicols}
% }
